<!DOCTYPE html>
<html lang="zh-CN">

<a target="_blank" rel="noopener" href="https://github.com/muyu42" class="github-corner" target = "_blank" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; z-index: 1033; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"muyu42.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
<meta property="og:type" content="website">
<meta property="og:title" content="cabbage">
<meta property="og:url" content="https://muyu42.github.io/page/2/index.html">
<meta property="og:site_name" content="cabbage">
<meta property="og:description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="muyu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://muyu42.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>cabbage</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">cabbage</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">菜鸟写给小白的教程</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2023/02/08/0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/08/0/" class="post-title-link" itemprop="url">【白菜】timm篇零：带你认识timm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-08 14:15:09" itemprop="dateCreated datePublished" datetime="2023-02-08T14:15:09Z">2023-02-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-21 08:04:54" itemprop="dateModified" datetime="2023-05-21T08:04:54Z">2023-05-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="timm库（CV利器）的入门教程"><a href="#timm库（CV利器）的入门教程" class="headerlink" title="timm库（CV利器）的入门教程"></a>timm库（CV利器）的入门教程</h1><blockquote>
<p>你是否想过用深度学习来解决一些视觉问题，比如图像分类、目标检测、人脸识别等？</p>
<p>你是否觉得深度学习的模型太多太复杂，不知道该如何选择和使用？</p>
<p>你是否曾经为了复现一篇论文的结果而苦苦寻找代码和权重，却发现官方没有提供或者提供的不完整？</p>
</blockquote>
<p><strong>如果你有以上的困惑，那么我要向你推荐一个神奇的库：timm。</strong></p>
<h2 id="啥是timm？"><a href="#啥是timm？" class="headerlink" title="啥是timm？"></a>啥是timm？</h2><p>timm 是 PyTorch Image Models 的缩写</p>
<p>is a collection of SOTA computer vision models, layers, utilities, optimizers, schedulers, data-loaders, augmentations and also training/validating scripts with ability to reproduce ImageNet training results.</p>
<p>timm 库实现了最新的几乎所有的具有影响力的视觉模型，它不仅提供了模型的权重，还提供了一个很棒的分布式训练和评估的代码框架，方便后人开发。</p>
<p>timm 库是由 Ross Wightman 开发和维护的</p>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/huggingface/pytorch-image-models">https://github.com/huggingface/pytorch-image-models</a></p>
<h2 id="写文原因："><a href="#写文原因：" class="headerlink" title="写文原因："></a>写文原因：</h2><p>我之所以写这篇文章，主要是出于以下几点：</p>
<ol>
<li><p>深度学习在各个领域都取得了令人惊叹的成就，比如自然语言处理、计算机视觉、AIGC等。作为一个对人工智能感兴趣并且想要从事相关工作或研究的人，我认为有必要掌握深度学习相关知识，并且跟进最新进展。</p>
</li>
<li><p>互联网是一个开放、自由、分享、进步 的平台。我非常欣赏并支持开源社区中那种无私奉献、相互帮助、共同成长的氛围。我也希望通过我的文章来分享我所学到或者感兴趣的东西，并且与读者们交流心得。</p>
</li>
<li><p>当我刚开始接触深度学习时，我遇到了很多困难和挫折。比如找不到合适的教程，网上信息良莠不齐，解决一个问题要搞好久。虽然我现在也还是菜鸡hh，但是我想把自己的学习经历和心得分享给那些想要入门CV的小白们，希望能够对你们有所帮助。同时，也欢迎各位大佬或者有兴趣的同学给我提出宝贵的意见和建议，让我们一起进步。</p>
</li>
<li><p>本来是想写完发，但是可能又会拖延，就先发出来一点，欢迎大家监督。可以加我的QQ：7914675，一起交流入门心得</p>
</li>
<li><p>还有一个原因，不过先容我卖个关子，等到这个timm的系列完结再说。</p>
</li>
</ol>
<h2 id="本系列的目录结构和跳转链接"><a href="#本系列的目录结构和跳转链接" class="headerlink" title="本系列的目录结构和跳转链接"></a>本系列的目录结构和跳转链接</h2><p>如下：</p>
<p>0.引言</p>
<p>1.简单的使用</p>
<p>2.训练自己的</p>
<p>3.pth下载到哪里了</p>
<p>4.修改模型 获取特征</p>
<p>5.create _model代码解读以及创建自己的模型</p>
<p>5.create_transform以及resolve_data_config代码解读</p>
<p>后续更新计划： 1.简单的使用model 2.训练自己的model 3.pth下载到哪里了 4.修改model 获取中间特征 5.create _model代码解读以及创建自己的模型 6.create_transform以及resolve_data_config代码解读 7.及以后 更多的tricks</p>
<p>帖子代码基于 timm0.54</p>
<p>之后放出codebook</p>
<h1 id="wx"><a href="#wx" class="headerlink" title="wx"></a>wx</h1><p><a target="_blank" rel="noopener" href="https://github.com/huggingface/pytorch-image-models">https://github.com/huggingface/pytorch-image-models</a></p>
<p><a target="_blank" rel="noopener" href="https://huggingface.co/docs/hub/timm">https://huggingface.co/docs/hub/timm</a></p>
<p><a target="_blank" rel="noopener" href="https://huggingface.co/docs/timm/index">https://huggingface.co/docs/timm/index</a></p>
<p><a target="_blank" rel="noopener" href="https://timm.fast.ai/training">https://timm.fast.ai/training</a></p>
<p><a target="_blank" rel="noopener" href="https://towardsdatascience.com/getting-started-with-pytorch-image-models-timm-a-practitioners-guide-4e77b4bf9055">https://towardsdatascience.com/getting-started-with-pytorch-image-models-timm-a-practitioners-guide-4e77b4bf9055</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/404107277">https://zhuanlan.zhihu.com/p/404107277</a></p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/">https://pytorch.org/tutorials/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2023/02/01/package7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/01/package7/" class="post-title-link" itemprop="url">optimzer</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-31 18:44:25" itemprop="dateCreated datePublished" datetime="2023-01-31T18:44:25Z">2023-01-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:53:39" itemprop="dateModified" datetime="2023-03-31T10:53:39Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" itemprop="url" rel="index"><span itemprop="name">基础操作</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="optimzer"><a href="#optimzer" class="headerlink" title="optimzer"></a>optimzer</h1><p>传统的训练函数，一个batch是这么训练的：</p>
<ol>
<li> 获取loss：输入图像和标签，通过infer计算得到预测值，计算损失函数；</li>
<li> optimizer.zero_grad() 清空过往梯度；</li>
<li> loss.backward() 反向传播，计算当前梯度；</li>
<li> optimizer.step() 根据梯度更新网络参数</li>
</ol>
<p>一、optimizer的基本参数<br>defaults：优化器超参数<br>state：参数的缓存，如momentum的缓存<br>param_groups：管理的参数组<br>_step_count：记录更新次数，学习率调整中使用（比如要在第n次迭代后降低学习率）</p>
<p>二、optimizer的基本使用方法<br>zero_grad()：清空所有参数的梯度，因为张量不会自动清零会自动累加，在梯度求导之前需要进行梯度清零<br>step()：进行一步更新<br>add_param_groups()：添加一组参数<br>state_dict()：获取优化器当前状态信息字典<br>load_state_dict()：加载状态信息字典<br>————————————————<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_55769743/article/details/122717287">https://blog.csdn.net/m0_55769743/article/details/122717287</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37628604/article/details/121630836">https://blog.csdn.net/m0_37628604/article/details/121630836</a><br>四个函数作用是先将梯度值归零(optimizer.zero_grad())，然后反向传播计算每个参数的梯度值（loss.backward()),通过梯度下降进行参数更新（optimizer.step()),最后根据opeoch训练轮数更新学习率(lr_scheduler.step())。</p>
<p>接下来通过源码对四个函数进行分析。在此之前说明函数中常见的参数变量。<br>param_groups:Optimizer类在实例化时会创建一个param_groups列表，列表中有num_groups（num_groups取决于你定义optimizer时传入了几组参数）个长度为6的param_group字典，每个param_group包含了[‘param’,‘lr’,‘momentum’,‘dampening’,‘weight_decay’,‘nesterov’]这6组键值对。<br>params（iterable）—待优化参数w、b 或者定义了参数组的dict<br>lr(float,可选)—学习率<br>momentum(float,可选，默认0）—动量因子<br>weight_decay(float，可选，默认0）—权重衰减<br>dampening (float, 可选) – 动量的抑制因子（默认：0）<br>nesterov (bool, 可选) – 使用Nesterov动量（默认：False）<br>param_group[‘param’]:由传入的模型参数组成的列表，即实例化Optimizer类时传入该group的参数，如果参数没有分组，则为整个模型的参数model.parameters(),每个参数是一个torch.nn.parameter.Parameter对象。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40379132/article/details/124573071">https://blog.csdn.net/qq_40379132/article/details/124573071</a> -仔细看看</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43863869/article/details/128120719">https://blog.csdn.net/weixin_43863869/article/details/128120719</a><br><img src="Pasted%20image%2020230331161118.png"></p>
<h2 id="梯度累计"><a href="#梯度累计" class="headerlink" title="梯度累计"></a>梯度累计</h2><p>简单的说就是进来一个batch的数据，计算一次梯度，更新一次网络<br>使用梯度累加是这么写的<br>获取loss：输入图像和标签，通过infer计算得到预测值，计算损失函数；<br>loss.backward() 反向传播，计算当前梯度；<br>多次循环步骤1-2，不清空梯度，使梯度累加在已有梯度上；<br>梯度累加了一定次数后，先optimizer.step() 根据累计的梯度更新网络参数，然后optimizer.zero_grad() 清空过往梯度，为下一波梯度累加做准备；</p>
<p>一定条件下，batchsize越大训练效果越好，梯度累加则实现了batchsize的变相扩大，如果accumulation_steps为8，则batchsize ‘变相’ 扩大了8倍，是我们这种乞丐实验室解决显存受限的一个不错的trick，使用时需要注意，学习率也要适当放大。</p>
<h2 id="对模型参数的梯度置0时通常使用两种方式：model-zero-grad-和optimizer-zero-grad-。二者在训练代码都很常见，那么二者的区别在哪里呢？"><a href="#对模型参数的梯度置0时通常使用两种方式：model-zero-grad-和optimizer-zero-grad-。二者在训练代码都很常见，那么二者的区别在哪里呢？" class="headerlink" title="对模型参数的梯度置0时通常使用两种方式：model.zero_grad()和optimizer.zero_grad()。二者在训练代码都很常见，那么二者的区别在哪里呢？"></a>对模型参数的梯度置0时通常使用两种方式：<code>model.zero_grad()</code>和<code>optimizer.zero_grad()</code>。二者在训练代码都很常见，那么二者的区别在哪里呢？</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chaofengya/p/16925125.html">https://www.cnblogs.com/chaofengya/p/16925125.html</a><br>转自 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1710864">https://cloud.tencent.com/developer/article/1710864</a></p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lishanlu136/article/details/121284421">https://blog.csdn.net/lishanlu136/article/details/121284421</a></p>
<h1 id="auto-grad"><a href="#auto-grad" class="headerlink" title="auto.grad"></a>auto.grad</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39208832/article/details/117415229">https://blog.csdn.net/qq_39208832/article/details/117415229</a></p>
<p><code>torch.Tensor</code> 是这个包的核心类。如果设置它的属性 <code>.requires_grad</code> 为 <code>True</code>，那么它将会追踪对于该张量的所有操作。当完成计算后可以通过调用 <code>.backward()</code>，来自动计算所有的梯度。这个张量的所有梯度将会自动累加到<code>.grad</code>属性.</p>
<p> 要阻止一个张量被跟踪历史，可以调用 <code>.detach()</code> 方法将其与计算历史分离，并阻止它未来的计算记录被跟踪。为了防止跟踪历史记录(和使用内存），可以将代码块包装在 <code>with torch.no_grad():</code> 中。在评估模型时特别有用，因为模型可能具有 <code>requires_grad = True</code> 的可训练的参数，但是我们不需要在此过程中对他们进行梯度计算。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/12/25/package6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/25/package6/" class="post-title-link" itemprop="url">dataloader</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-25 08:44:20" itemprop="dateCreated datePublished" datetime="2022-12-25T08:44:20Z">2022-12-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:51:49" itemprop="dateModified" datetime="2023-03-31T10:51:49Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%96%B0%E4%BA%BA%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">新人入门</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53345829/article/details/124308515">https://blog.csdn.net/qq_53345829/article/details/124308515</a></p>
<p>pytorch加载图片数据集有两种方法。</p>
<p>orch能处理的数据只能是torch.Tensor，所以有必要将其他数据转换为torch.Tensor。</p>
<p>常见的有几种数据：</p>
<p>np.ndarray<br>PIL.Image</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a19990412/article/details/105402341/">https://blog.csdn.net/a19990412/article/details/105402341/</a></p>
<p>创建自己的数据集需要继承父类torch.utils.data.Dataset，同时需要重载两个私有成员函数：def <strong>len</strong>(self)和def <strong>getitem</strong>(self, index) 。 def <strong>len</strong>(self)应该返回数据集的大小；def <strong>getitem</strong>(self, index)接收一个index，然后返回图片数据和标签，这个index通常指的是一个list的index，这个list的每个元素就包含了图片数据的路径和标签信息。如何制作这个list呢，通常的方法是将图片的路径和标签信息存储在一个txt中，然后从该txt中读取。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Vertira/article/details/127482001">https://blog.csdn.net/Vertira/article/details/127482001</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38683460/article/details/123306447">https://blog.csdn.net/qq_38683460/article/details/123306447</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zwy_697198/article/details/123561769">https://blog.csdn.net/zwy_697198/article/details/123561769</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41140138/article/details/127084076">https://blog.csdn.net/qq_41140138/article/details/127084076</a></p>
<p>Image.open(ImgPath)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43723625/article/details/108158375">https://blog.csdn.net/weixin_43723625/article/details/108158375</a></p>
<h2 id="3-DataLoader"><a href="#3-DataLoader" class="headerlink" title="3.DataLoader"></a>3.DataLoader</h2><p>提供对<code>Dataset</code>的操作，操作如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">torch.utils.data.DataLoader(dataset,batch_size,shuffle,drop_last，num_workers)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>参数含义如下：</p>
<ul>
<li>d a t a s e t \color{HotPink}{dataset}<em>d<strong>a</strong>t<strong>a</strong>se**t</em>： 加载torch.utils.data.Dataset对象数据</li>
<li>b a t c h _ s i z e \color{HotPink}{batch_size}<em>ba<strong>t</strong>c**h</em>_<em>s<strong>i</strong>ze</em>： 每个batch的大小</li>
<li>s h u f f l e \color{HotPink}{shuffle}<em>s<strong>h</strong>u<strong>ff</strong>l**e</em>：是否对数据进行打乱</li>
<li>d r o p _ l a s t \color{HotPink}{drop_last}<em>d<strong>ro</strong>p</em>_<em>l<strong>a</strong>s**t</em>：是否对无法整除的最后一个datasize进行丢弃</li>
<li>n u m _ w o r k e r s \color{HotPink}{num_workers}<em>n<strong>u</strong>m</em>_<em>w<strong>or</strong>k**ers</em>：表示加载的时候子进程数</li>
</ul>
<p>因此，在实现过程中我们测试如下（紧跟上述用例）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">datas = DataLoader(torch_data, batch_size=<span class="number">6</span>, shuffle=<span class="literal">True</span>, drop_last=<span class="literal">False</span>, num_workers=<span class="number">2</span>)</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>

<p>此时，我们的数据已经加载完毕了，只需要在训练过程中使用即可。</p>
<h2 id="4-查看数据"><a href="#4-查看数据" class="headerlink" title="4.查看数据"></a>4.查看数据</h2><p>我们可以通过迭代器<code>（enumerate）</code>进行输出数据，测试如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(datas):</span><br><span class="line">	<span class="comment"># i表示第几个batch， data表示该batch对应的数据，包含data和对应的labels</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第 &#123;&#125; 个Batch \n&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i, data))</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/12/03/package5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/03/package5/" class="post-title-link" itemprop="url">package5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-03 09:44:06" itemprop="dateCreated datePublished" datetime="2022-12-03T09:44:06Z">2022-12-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:45:56" itemprop="dateModified" datetime="2023-03-31T10:45:56Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" itemprop="url" rel="index"><span itemprop="name">基础操作</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="相互转换"><a href="#相互转换" class="headerlink" title="相互转换"></a>相互转换</h1><p>使用pandas，可以写入到csv或者xlsx格式文件</p>
<p>import pandas as pd</p>
<p>result_list = [[‘1’, 1, 1], [‘2’, 2, 2], [‘3’, 3, 3]]</p>
<p>columns = [“URL”, “predict”, “score”]</p>
<p>dt = pd.Dataframe(result_list, columns=columns)</p>
<p>dt.to_excel(“result_xlsx.xlsx”, index=0)</p>
<p>dt.to_csv(“result_csv.csv”, index=0)</p>
<p>excel文件转csv</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44416114/article/details/123894189">https://blog.csdn.net/weixin_44416114/article/details/123894189</a></p>
<p>平时开发时文件读写都是csv比较简单方便，不过有时需要给别人提供excel，或者别人提供excel给自己，那么csv和excel的互转工具就十分有必要写一个了</p>
<p>下面代码保存一个py文件，比如 <code>csvtool.py</code>，放到csv或者excel所在的文件夹，运行即可</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40476348/article/details/120345498">https://blog.csdn.net/weixin_40476348/article/details/120345498</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42171682/article/details/120431054">https://blog.csdn.net/weixin_42171682/article/details/120431054</a></p>
<h1 id="使用python读取和保存为excel、csv、txt文件以及对DataFrame文件的基本操作"><a href="#使用python读取和保存为excel、csv、txt文件以及对DataFrame文件的基本操作" class="headerlink" title="使用python读取和保存为excel、csv、txt文件以及对DataFrame文件的基本操作"></a>使用python读取和保存为excel、csv、txt文件以及对DataFrame文件的基本操作</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45928096/article/details/124034946">https://blog.csdn.net/weixin_45928096/article/details/124034946</a></p>
<h1 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h1><p>通用啊，前面的了解了解就行了</p>
<p>真正格式转换，读取数据，还是这个好用</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/npm_run_dev__/article/details/125881177DataFrame%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%BB%93%E6%9E%84">https://blog.csdn.net/npm_run_dev__/article/details/125881177DataFrame对象的结构</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Xiaoyuteacher/article/details/117993785">https://blog.csdn.net/Xiaoyuteacher/article/details/117993785</a></p>
<h2 id="1、os获取文件夹下所有文件"><a href="#1、os获取文件夹下所有文件" class="headerlink" title="1、os获取文件夹下所有文件"></a><strong>1、os获取文件夹下所有文件</strong></h2><p>方法一：读取文件夹下所有文件名（不读取子文件夹下文件名，顺序为乱序）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采用os.listdir（）函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listdir</span>(<span class="params">path</span>):</span>            <span class="comment">#path为文件夹的存储路径</span></span><br><span class="line">    list_name=[]              <span class="comment">#保存所有文件名至列表</span></span><br><span class="line">    list_dir = os.listdir(path)</span><br><span class="line">    <span class="comment"># list_dir.sort(key=lambda x:int(x[:-5])) #若文件名无中文，可对列表进行排序</span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> list_dir:                     <span class="comment">#由于子文件名后缀为.xlsx，因此为-5</span></span><br><span class="line">        file_path = os.path.join(path, file)</span><br><span class="line">        list_name.append(file_path)</span><br><span class="line">    <span class="keyword">return</span> list_name</span><br></pre></td></tr></table></figure>

<p>方法二：读取文件夹下指定后缀文件名（包括子文件下文件名，顺序为乱序）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#采用os.walk（）方法，读取文件夹中后缀为.csv的文件名</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listdir2</span>(<span class="params">path</span>):</span>          <span class="comment">#path为文件夹的存储路径   </span></span><br><span class="line">    <span class="built_in">type</span> = (<span class="string">&#x27;.csv&#x27;</span>)	     <span class="comment">#可在此处更改文件类型</span></span><br><span class="line">    list_name = []           <span class="comment">#保存所有文件名至列表</span></span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(path):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">            fname = os.path.join(root, f)</span><br><span class="line">            <span class="keyword">if</span> fname.endswith(<span class="built_in">type</span>):</span><br><span class="line">                list_name.append(fname)</span><br><span class="line">    <span class="keyword">return</span> list_name</span><br></pre></td></tr></table></figure>

<p><strong>2、读取多个excel内容存到list中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#函数的输入为列表，存储着多张excel的文件位置</span></span><br><span class="line"><span class="comment">#函数的输出为二维列表，保存着多张excel的内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">textList</span>(<span class="params">list_name</span>):</span>      <span class="comment">#list_name为多张表的位置信息列表</span></span><br><span class="line">    text_excel = []           <span class="comment">#text_excel为存储多张表的二维列表</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> list_name:</span><br><span class="line">        excel = pd.read_excel(num, header=<span class="literal">None</span>, skiprows=<span class="number">0</span>)</span><br><span class="line">        excel = excel.values.tolist()</span><br><span class="line">        text_excel.extend(excel)</span><br><span class="line">    <span class="keyword">return</span> text_excel</span><br></pre></td></tr></table></figure>

<p><strong>3、将二维列表的值写入excel中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用openpyxl模块实现，还有一种常用的是利用pandas模块，后续进行介绍</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writeToExcel</span>(<span class="params">file_path, new_list</span>):</span>   <span class="comment">#file_path为excel存储路径，new_list为二维列表</span></span><br><span class="line">    wb = openpyxl.Workbook()</span><br><span class="line">    ws = wb.active</span><br><span class="line">    ws.title = <span class="string">&#x27;feature&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(new_list)):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(new_list[<span class="number">0</span>])):</span><br><span class="line">            ws.cell(r + <span class="number">1</span>, c + <span class="number">1</span>).value = new_list[r][c]</span><br><span class="line">            <span class="comment"># excel中的行和列是从1开始计数的，所以需要+1</span></span><br><span class="line">    wb.save(file_path)  <span class="comment"># 注意，写入后一定要保存</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;成功写入文件: &quot;</span> + file_path + <span class="string">&quot; !&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>4、批量更改excel文件名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#批量修改文件中excel文件名，使用到1中listdir（）函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rename_excel</span>(<span class="params">path, text</span>):</span>  <span class="comment">#path为存储文件夹，text为替换的新内容</span></span><br><span class="line">    list_name = listdir(path)</span><br><span class="line">    <span class="keyword">for</span> excel_name <span class="keyword">in</span> list_name:</span><br><span class="line">        new_name = excel_name[:-<span class="number">10</span>] + text + excel_name[-<span class="number">8</span>:]</span><br><span class="line">        os.rename(excel_name, new_name)</span><br><span class="line">    <span class="keyword">return</span> list_name </span><br><span class="line">rename_excel(<span class="string">r&#x27;D:\test&#x27;</span>, <span class="string">&#x27;27&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>执行效果，文件夹中excel命名如下：<br><img src="package5/20210617145701695.png" alt="在这里插入图片描述"><br>批量将“26”改为“27”，程序执行结果为：<br><img src="package5/20210617145707470.png" alt="在这里插入图片描述"></p>
<p><strong>5、给csv添加第一列，第一列的值为日期</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#给csv添加一列，该列表示时间，全部设为2021-04-26</span></span><br><span class="line">data = pd.read_csv(<span class="string">r&#x27;test.csv&#x27;</span>,sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="literal">None</span>,skiprows=<span class="number">1</span>,encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line">col_name = data.columns.tolist()           <span class="comment">#读取列名，并放入list中</span></span><br><span class="line">col_name.insert(<span class="number">0</span>,<span class="string">&#x27;DATE&#x27;</span>)                  <span class="comment">#给list中插入第一列</span></span><br><span class="line">new_data = data.reindex(columns=col_name)  <span class="comment">#列名重命名</span></span><br><span class="line">new_data[<span class="string">&#x27;DATE&#x27;</span>]=<span class="string">&#x27;2021-04-26&#x27;</span>              <span class="comment">#给第一列赋值</span></span><br><span class="line">new_data.to_csv(<span class="string">&#x27;new_test.csv&#x27;</span>,index=<span class="number">0</span>)    <span class="comment">#写入新的csv文件</span></span><br></pre></td></tr></table></figure>

<p><strong>6、批量修改csv中的值，并写入新的csv中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取csv的值，第一列为时间类型，大小不变，对其余列生成随机数字</span></span><br><span class="line">data = pd.read_csv(path, sep=<span class="string">&#x27;,&#x27;</span>,header=<span class="literal">None</span>, skiprows=<span class="number">1</span>, encoding=<span class="string">&quot;gbk&quot;</span>)  <span class="comment">#原始数据</span></span><br><span class="line">col_name = <span class="built_in">list</span>(data)   <span class="comment">#返回列名</span></span><br><span class="line">new_col = col_name[<span class="number">1</span>:]  <span class="comment">#取除第一列之外其余列的名称</span></span><br><span class="line">col = data.shape[<span class="number">1</span>]     <span class="comment">#返回列数</span></span><br><span class="line">index = data.shape[<span class="number">0</span>]   <span class="comment">#返回行数</span></span><br><span class="line"><span class="comment">#给其余列随机生成[0-100]之间的数字</span></span><br><span class="line">new_data_randam = pd.DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">100</span>,size=(index, col-<span class="number">1</span>)), columns = new_col)</span><br><span class="line">new_col_name = new_data_randam.columns.tolist() <span class="comment">#生成新的列名</span></span><br><span class="line">new_col_name.insert(<span class="number">0</span>, <span class="string">&#x27;DATE&#x27;</span>)                  <span class="comment">#插入日期为第一列</span></span><br><span class="line">new_test_data = new_data_randam.reindex(columns=new_col_name)  <span class="comment">#列名重命名</span></span><br><span class="line">new_test_data[<span class="string">&#x27;DATE&#x27;</span>] = <span class="string">&#x27;2021-04-26&#x27;</span>            <span class="comment">#给第一列进行赋值</span></span><br></pre></td></tr></table></figure>

<p><strong>7、csv每隔10行取1行，并写入新的csv中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取csv的内容，每10条进行抽样，path为csv文件位置，new_path为新的存储位置</span></span><br><span class="line">data = pd.read_csv(path, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="literal">None</span>, skiprows=<span class="number">1</span>, encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line">sample = []                                  <span class="comment">#存储抽样的行数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">10</span>):            <span class="comment">#每隔10行取数据</span></span><br><span class="line">  sample.append(i)</span><br><span class="line">  new_data = data.iloc[sample]               <span class="comment">#根据行数对数据进行抽样</span></span><br><span class="line">  new_data = pd.DataFrame(new_data)</span><br><span class="line">new_data.to_csv(new_path, index=<span class="number">0</span>, header=<span class="number">0</span>)  <span class="comment"># 写入新的csv文件</span></span><br></pre></td></tr></table></figure>

<p><strong>8、csv按列求均值、最大值、最小值，并写入新的csv中</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#利用dataframe的.mean（）.max（）.min（）函数分别求各列的均值、最大值和最小值</span></span><br><span class="line"><span class="comment">#path为csv的存储路径，new_path_mean为均值存储路径，new_path_max为最大值存储路径，new_path_min为最小值存储路径</span></span><br><span class="line">data = pd.read_csv(path, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="literal">None</span>, skiprows=<span class="number">1</span>, encoding=<span class="string">&quot;gbk&quot;</span>)</span><br><span class="line">data_mean = data.mean(axis=<span class="number">0</span>))   <span class="comment">#均值，axis=1时，为对行求均值</span></span><br><span class="line">data_max =  data.<span class="built_in">max</span>(axis=<span class="number">0</span>))    <span class="comment">#最大值</span></span><br><span class="line">data_min =  data.<span class="built_in">min</span>(axis=<span class="number">0</span>)))   <span class="comment">#最小值</span></span><br><span class="line"><span class="comment"># 均值写入新的csv文件</span></span><br><span class="line">data_mean.to_csv(new_path_mean, index=<span class="number">0</span>, header=<span class="number">0</span>, mode=<span class="string">&#x27;a&#x27;</span>)   <span class="comment"># mode=&#x27;a&#x27;为追加模式</span></span><br><span class="line"><span class="comment"># 最大值写入新的csv文件</span></span><br><span class="line">data_max.to_csv(new_path_max, index=<span class="number">0</span>, header=<span class="number">0</span>, mode=<span class="string">&#x27;a&#x27;</span>)     <span class="comment">#mode=&#x27;w&#x27;为写模式</span></span><br><span class="line"><span class="comment"># 最小值写入新的csv文件</span></span><br><span class="line">data_min.to_csv(new_path_min, index=<span class="number">0</span>, header=<span class="number">0</span>, mode=<span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/12/02/package4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/02/package4/" class="post-title-link" itemprop="url">package4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-01 18:34:25" itemprop="dateCreated datePublished" datetime="2022-12-01T18:34:25Z">2022-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:45:14" itemprop="dateModified" datetime="2023-03-31T10:45:14Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" itemprop="url" rel="index"><span itemprop="name">基础操作</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="excel文件"><a href="#excel文件" class="headerlink" title="excel文件"></a>excel文件</h1><p>工作簿：一个excel文件就是一个工作簿</p>
<p>工作表：一个工作簿中可以有多个工作表（至少一个）</p>
<p>单元格：单元格是excel文件保存数据的基本单位</p>
<p>行号和列号：可以确定单元格位置</p>
<p><code>import openpyxl</code> </p>
<h2 id="excel读操作"><a href="#excel读操作" class="headerlink" title="excel读操作"></a>excel读操作</h2><h3 id="1）打开excel文件创建工作簿对象"><a href="#1）打开excel文件创建工作簿对象" class="headerlink" title="1）打开excel文件创建工作簿对象"></a>1）打开excel文件创建工作簿对象</h3><blockquote>
<p>openpyxl.open(excel文件路径)</p>
<p>openpyxl.load_workbook(excel文件路径)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line">workbook = openpyxl.<span class="built_in">open</span>(<span class="string">&#x27;excel_file/三国人物数据.xlsx&#x27;</span>)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">workbook = openpyxl.load_workbook(<span class="string">&#x27;excel_file/三国人物数据.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2）获取工作表"><a href="#2）获取工作表" class="headerlink" title="2）获取工作表"></a>2）获取工作表</h3><blockquote>
<p>工作簿对象.active - 获取活跃表（选中的表）</p>
<p>工作簿对象[工作表名称] - 获取指定名字对应的工作表</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sheet1 = workbook.active</span><br><span class="line"><span class="built_in">print</span>(sheet1)</span><br><span class="line"></span><br><span class="line">sheet2 = workbook[<span class="string">&#x27;工作表名称&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(sheet2)</span><br></pre></td></tr></table></figure>

<p><strong>如果要获取工作簿中所有的工作表表名</strong></p>
<blockquote>
<p>workbook.sheetnames</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = workbook.sheetnames</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h3 id="3）获取单元格"><a href="#3）获取单元格" class="headerlink" title="3）获取单元格"></a>3）获取单元格</h3><blockquote>
<p>工作表对象.cell(行号, 列号)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cell1 = sheet2.cell(<span class="number">8</span>, <span class="number">1</span>)</span><br><span class="line">cell2 = sheet2.cell(<span class="number">12</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(cell1, cell2)</span><br></pre></td></tr></table></figure>

<h3 id="4）获取单元格内容"><a href="#4）获取单元格内容" class="headerlink" title="4）获取单元格内容"></a>4）获取单元格内容</h3><blockquote>
<p>单元格对象.value</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(cell1.value)</span><br><span class="line"><span class="built_in">print</span>(cell2.value)</span><br></pre></td></tr></table></figure>

<h3 id="5）获取最大行号和最大列号（保存了数据的有效行和有效列）"><a href="#5）获取最大行号和最大列号（保存了数据的有效行和有效列）" class="headerlink" title="5）获取最大行号和最大列号（保存了数据的有效行和有效列）"></a>5）获取最大行号和最大列号（保存了数据的有效行和有效列）</h3><blockquote>
<p>工作表对象.max_row</p>
<p>工作表对象.max_column</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(sheet2.max_row)</span><br><span class="line"><span class="built_in">print</span>(sheet2.max_column)</span><br></pre></td></tr></table></figure>

<h2 id="excel文件写操作"><a href="#excel文件写操作" class="headerlink" title="excel文件写操作"></a>excel文件写操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：不管是以什么样的方式对excel进行写操作，操作完成之后必须保存</span><br></pre></td></tr></table></figure>

<h3 id="（一）新建工作簿"><a href="#（一）新建工作簿" class="headerlink" title="（一）新建工作簿"></a>（一）新建工作簿</h3><h4 id="1）新建工作簿对象"><a href="#1）新建工作簿对象" class="headerlink" title="1）新建工作簿对象"></a>1）新建工作簿对象</h4><blockquote>
<p>openpyxl.Workbook()</p>
</blockquote>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">workbook = openpyxl.Workbook()</span><br></pre></td></tr></table></figure>

<h4 id="2）保存"><a href="#2）保存" class="headerlink" title="2）保存"></a>2）保存</h4><blockquote>
<p>工作簿对象.save(文件路径)</p>
</blockquote>
<p><strong>实际中新建工作簿的时候需要先判断工作簿对应的文件是否已经存在，存在就不需要新建，不存在才新建</strong></p>
<p><em>法一</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    workbook = openpyxl.<span class="built_in">open</span>(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    workbook = openpyxl.Workbook()</span><br><span class="line">    workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><em>法二</em></p>
<blockquote>
<p>os.path.exists(文件路径) - 判断指定文件是否存在，存在返回True，不存在返回False</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>):</span><br><span class="line">    workbook = openpyxl.<span class="built_in">open</span>(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    workbook = openpyxl.Workbook()</span><br><span class="line">    workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="（二）工作表的写操作"><a href="#（二）工作表的写操作" class="headerlink" title="（二）工作表的写操作"></a>（二）工作表的写操作</h3><h4 id="1）新建工作表"><a href="#1）新建工作表" class="headerlink" title="1）新建工作表"></a>1）新建工作表</h4><blockquote>
<p>工作簿对象.create_sheet(表名, 下标)</p>
</blockquote>
<p><strong>实际中的新建表：没有的时候才新建，有的时候直接打开</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Python&#x27;</span> <span class="keyword">in</span> workbook.sheetnames:</span><br><span class="line">    sheet = workbook[<span class="string">&#x27;Python&#x27;</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sheet = workbook.create_sheet(<span class="string">&#x27;Python&#x27;</span>)</span><br><span class="line">    workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="2）删除工作表"><a href="#2）删除工作表" class="headerlink" title="2）删除工作表"></a>2）删除工作表</h4><blockquote>
<p>工作簿对象.remove(工作表对象)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">workbook.remove(workbook[<span class="string">&#x27;Sheet1&#x27;</span>])</span><br><span class="line">workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>实际中删除表：存在的时候才能删</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Sheet1&#x27;</span> <span class="keyword">in</span> workbook.sheetnames:</span><br><span class="line">    workbook.remove(workbook[<span class="string">&#x27;Sheet1&#x27;</span>])</span><br><span class="line">    workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="（三）单元格的写操作"><a href="#（三）单元格的写操作" class="headerlink" title="（三）单元格的写操作"></a>（三）单元格的写操作</h3><blockquote>
<p>单元格对象.value = 数据</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java_sheet = workbook[<span class="string">&#x27;Java&#x27;</span>]</span><br><span class="line">java_sheet.cell(<span class="number">1</span>, <span class="number">3</span>).value = <span class="string">&#x27;电话&#x27;</span></span><br><span class="line">java_sheet.cell(<span class="number">2</span>, <span class="number">1</span>).value = <span class="literal">None</span></span><br><span class="line">java_sheet.cell(<span class="number">4</span>, <span class="number">2</span>).value = <span class="string">&#x27;stu003&#x27;</span></span><br><span class="line"></span><br><span class="line">workbook.save(<span class="string">&#x27;excel_file/student2.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/12/02/6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/02/6/" class="post-title-link" itemprop="url">timm y原理待写</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-01 18:31:56" itemprop="dateCreated datePublished" datetime="2022-12-01T18:31:56Z">2022-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-21 13:25:31" itemprop="dateModified" datetime="2023-05-21T13:25:31Z">2023-05-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/timm/" itemprop="url" rel="index"><span itemprop="name">timm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><h2 id="registry"><a href="#registry" class="headerlink" title="registry"></a>registry</h2><p>在了解了 <code>create_model</code> 函数的基本使用之后，我们来深入探索一下 <code>create_model</code> 函数的源码，看一下究竟是怎样实现从模型到特征提取器的转换的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44966641/article/details/121364784">https://blog.csdn.net/weixin_44966641/article/details/121364784</a></p>
<p>在 timm 内部，有一个字典称为 <code>_model_entrypoints</code> 包含了所有的模型名称和他们各自的函数。比如说，我们可以通过 <code>model_entrypoint</code> 函数从 <code>_model_entrypoints</code> 内部得到 <code>xception71</code> 模型的构造函数。</p>
<p>如我们所见，在 <code>timm.models.xception_aligned</code> 模块中有一个函数称为 <code>xception71</code> 。类似的，timm 中的每一个模型都有着一个这样的构造函数。事实上，内部的 <code>_model_entrypoints</code> 字典大概长这个样子：</p>
<details style='background-color:#f9f2f4'> <summary><font color='#c7254e' size='3px'> view code</font></summary>  不适合放代码，都锁在一起了  </details>


<p>在 timm 对应的模块中，每个模型都有一个构造器。比如说 ResNets 系列模型被定义在 <code>timm.models.resnet</code> 模块中。因此，实际上我们有两种方式来创建一个 <code>resnet34</code> 模型</p>
<p>import timm from timm.models.resnet import resnet34 <em># 使用 create_model</em> m = timm.create_model(‘resnet34’) <em># 直接调用构造函数</em> m = resnet34()</p>
<p>但使用上，我们无须调用构造函数。所用模型都可以通过 <code>create_model</code> 函数来将创建。</p>
<h1 id="画图，话一个相互之间构成联系的图"><a href="#画图，话一个相互之间构成联系的图" class="headerlink" title="画图，话一个相互之间构成联系的图"></a>画图，话一个相互之间构成联系的图</h1><p>whiteboard</p>
<p>boardmix</p>
<h1 id="0521"><a href="#0521" class="headerlink" title="0521"></a>0521</h1><p>create_dataset</p>
<p>Dataset factory method 创建数据集，返回一个数据集对象</p>
<h2 id="支持加载的数据集"><a href="#支持加载的数据集" class="headerlink" title="支持加载的数据集"></a>支持加载的数据集</h2><p>1.folder类型：基于文件夹结构组织的数据集（比如说imagenet）</p>
<p>2.torch类型：基于torchvision的数据集（cifar10/100/MNIST/places365）</p>
<p>3.TFDS类型：通过IterableImageDataset在IterabeDataset接口中的Tensorflow数据集包装器</p>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def create_dataset(</span><br><span class="line">        name,</span><br><span class="line">        root,</span><br><span class="line">        split=&#x27;validation&#x27;,</span><br><span class="line">        search_split=True,</span><br><span class="line">        class_map=None,</span><br><span class="line">        load_bytes=False,</span><br><span class="line">        is_training=False,</span><br><span class="line">        download=False,</span><br><span class="line">        batch_size=None,</span><br><span class="line">        repeats=0,</span><br><span class="line">        **kwargs</span><br><span class="line">):</span><br></pre></td></tr></table></figure>

<p>看的头大？没事，下面带你一个一个看，给出解释和建议的参数，一般也用不到这么多参数啦，按照参数重要性讲解</p>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><h3 id="name-数据集名称（重要）"><a href="#name-数据集名称（重要）" class="headerlink" title="name 数据集名称（重要）"></a>name 数据集名称（重要）</h3><p>数据集名称</p>
<p>对于基于文件夹的数据集（folder）可以为空</p>
<p>有坑，如果是想加载cifar10，则name需要写为<code>torch/CIFAR10</code>  这也是我为什么不太喜欢封装的太深的</p>
<h3 id="root-数据集的根文件夹（必需）"><a href="#root-数据集的根文件夹（必需）" class="headerlink" title="root:数据集的根文件夹（必需）"></a>root:数据集的根文件夹（必需）</h3><p>数据集所在位置根目录</p>
<p>如果没有该数据集，启用download参数会自动下载文件夹在该路径</p>
<h3 id="split-划分数据集（必需-默认为val）"><a href="#split-划分数据集（必需-默认为val）" class="headerlink" title="split 划分数据集（必需-默认为val）"></a>split 划分数据集（必需-默认为val）</h3><p>train 和 val的数据集都由这个create_dataset函数确立，那么如何区分呢，重点就是这个参数。</p>
<p>不同数据集有不同的划分，这里不用管，他有一个字典。不管你输入是train还是training，都会自动识别，并根据数据集给出正确的划分</p>
<p>val/valid/validation/eval/evaluation也一样</p>
<h3 id="download-自动下载数据集（重要-torch-TFDS类型）"><a href="#download-自动下载数据集（重要-torch-TFDS类型）" class="headerlink" title="download 自动下载数据集（重要-torch/TFDS类型）"></a>download 自动下载数据集（重要-torch/TFDS类型）</h3><p>默认为Fasle，第一次的话可以指定为True自动下载数据集</p>
<p>如果之前指定的root路径中没有数据集</p>
<p>则自动下载数据集到root目录，仅支持torch类型和TFDS类型</p>
<p>imagenet需要自己下载</p>
<p>cifar10我试了一下，大概20min下好，之后就可以快了的使用了</p>
<h3 id="search-split-自主找到划分（folder）"><a href="#search-split-自主找到划分（folder）" class="headerlink" title="_search_split 自主找到划分（folder）"></a>_search_split 自主找到划分（folder）</h3><p>默认为True不用改</p>
<p>如果是folder类型，则调用<code>_search_split()</code> 函数</p>
<p>从根目录中搜索拆分特定的子文件夹，以便指定<code>imagenet/</code>而不是<code>/imagenet/val</code>等</p>
<h3 id="class-map-索引映射（folder）"><a href="#class-map-索引映射（folder）" class="headerlink" title="class_map 索引映射（folder）"></a>class_map 索引映射（folder）</h3><p>把输出的tensor映射成实际的类别</p>
<p>一般不用，不用管，默认为None</p>
<h3 id="load-bytes（folder）"><a href="#load-bytes（folder）" class="headerlink" title="load_bytes（folder）"></a>load_bytes（folder）</h3><p>加载数据，以未编码字节的形式返回图像</p>
<p>一般不用，不用管</p>
<h3 id="batch-size-is-training-repeats（TFDS类型）"><a href="#batch-size-is-training-repeats（TFDS类型）" class="headerlink" title="batch_size/is_training/repeats（TFDS类型）"></a>batch_size/is_training/repeats（TFDS类型）</h3><p>一般用不到，不管了</p>
<h1 id="0521-create-loader"><a href="#0521-create-loader" class="headerlink" title="0521-create_loader"></a>0521-create_loader</h1><h2 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h2><p>def create_loader(</p>
<p>​    dataset,</p>
<p>​    <strong>input_size,</strong></p>
<p>​    batch_size,</p>
<p>​    <strong>is_training=False,</strong></p>
<p>​    <strong>use_prefetcher=True,</strong></p>
<p>​    <strong>no_aug=False,</strong></p>
<p>​    <strong>re_prob=0.,</strong></p>
<p>​    <strong>re_mode=’const’,</strong></p>
<p>​    <strong>re_count=1,</strong></p>
<p>​    re_split=False,<strong>（re_num_splits = 0 if re_split:  re_num_splits = num_aug_splits or 2）</strong></p>
<p>​    <strong>scale=None,</strong></p>
<p>​    <strong>ratio=None,</strong></p>
<p>​    <strong>hflip=0.5,</strong></p>
<p>​    <strong>vflip=0.,</strong></p>
<p>​    <strong>color_jitter=0.4,</strong></p>
<p>​    <strong>auto_augment=None,</strong></p>
<p>​    **num_aug_repeats=0,**（re_num_splits = 0 if re_split:  re_num_splits = num_aug_splits or 2）</p>
<p>​    **num_aug_splits=0,**（separate=num_aug_splits &gt; 0,）</p>
<p>​    <strong>interpolation=’bilinear’,</strong></p>
<p>​    <strong>mean=IMAGENET_DEFAULT_MEAN,</strong></p>
<p>​    <strong>std=IMAGENET_DEFAULT_STD,</strong></p>
<p>​    num_workers=1,</p>
<p>​    distributed=False,</p>
<p>​    <strong>crop_pct=None,</strong></p>
<p>​    collate_fn=None,</p>
<p>​    pin_memory=False,</p>
<p>​    fp16=False,</p>
<p>​    <strong>tf_preprocessing=False,</strong></p>
<p>​    use_multi_epochs_loader=False,</p>
<p>​    persistent_workers=True,</p>
<p>​    worker_seeding=’all’,</p>
<p>):</p>
<h1 id="0522-create-transform"><a href="#0522-create-transform" class="headerlink" title="0522-create_transform"></a>0522-create_transform</h1><p>def create_transform(</p>
<p>​    input_size,</p>
<p>​    is_training=False,</p>
<p>​    use_prefetcher=False,</p>
<p>​    no_aug=False,</p>
<p>​    scale=None,</p>
<p>​    ratio=None,</p>
<p>​    hflip=0.5,</p>
<p>​    vflip=0.,</p>
<p>​    color_jitter=0.4,</p>
<p>​    auto_augment=None,</p>
<p>​    interpolation=’bilinear’,</p>
<p>​    mean=IMAGENET_DEFAULT_MEAN,</p>
<p>​    std=IMAGENET_DEFAULT_STD,</p>
<p>​    re_prob=0.,</p>
<p>​    re_mode=’const’,</p>
<p>​    re_count=1,</p>
<p>​    re_num_splits=0,</p>
<p>​    crop_pct=None,</p>
<p>​    tf_preprocessing=False,</p>
<p>​    separate=False):</p>
<p>dataloader内部代码中，实际还是基于torch的加载</p>
<p>loader_class = torch.utils.data.DataLoader</p>
<p>loader = loader_class(dataset, **loader_args)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43118280/article/details/124005396">(26条消息) timm.data.create_transform_alien丿明天的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/YJYS_ZHX/article/details/115680643">(26条消息) 【transformer】【pytorch】DeiT的数据增强_create_transform_剑宇2022的博客-CSDN博客</a></p>
<h1 id="0522"><a href="#0522" class="headerlink" title="0522-"></a>0522-</h1><p>#这里加载cifar数据集<br>#3套方法timm/ torch/加载自己数据集<br>#基于torch在这个时候就transformer了（getitem）/timm的在loader的时候才（dataset.transform = create_transform）<br>#和分布式 pin memory</p>
<h1 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/183243079">pytorch训练步骤总结 - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/cs230-stanford/cs230-code-examples/tree/master/pytorch/nlp">cs230-code-examples/pytorch/nlp at master · cs230-stanford/cs230-code-examples · GitHub</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/cs230-stanford/cs230-code-examples/blob/master/pytorch/vision/train.py">cs230-code-examples/train.py at master · cs230-stanford/cs230-code-examples · GitHub</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/396666255">深度学习pytorch训练代码模板(个人习惯) - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/396666255">深度学习pytorch训练代码模板(个人习惯) - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/352525266">(6 封私信 / 80 条消息) 如何提高自己的代码能力以达到熟练使用pytorch? - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44493291/article/details/111932895">(27条消息) 【Pytorch】学习笔记（训练代码框架）_Chaossll的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/FUTEROX/article/details/122724634">(27条消息) Pytorch模型训练&amp;保存/加载（搭建完整流程）_pytorch训练模型_Huterox的博客-CSDN博客</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/11/03/package2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/03/package2/" class="post-title-link" itemprop="url">package2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-11-02 20:34:09" itemprop="dateCreated datePublished" datetime="2022-11-02T20:34:09Z">2022-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:59:05" itemprop="dateModified" datetime="2023-03-31T10:59:05Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/package/" itemprop="url" rel="index"><span itemprop="name">package</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>os</p>
<h1 id="listdir"><a href="#listdir" class="headerlink" title="listdir()"></a>listdir()</h1><p>os.listdir() 函数用于返回指定目录下的文件和文件夹的名称列表。</p>
<p>语法: os.listdir(path) 参数: path : 指定的目录。 返回值: 返回指定目录下的文件和文件夹的名称列表</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/11/01/package1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/01/package1/" class="post-title-link" itemprop="url">package1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-31 18:34:05" itemprop="dateCreated datePublished" datetime="2022-10-31T18:34:05Z">2022-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-31 10:40:32" itemprop="dateModified" datetime="2023-03-31T10:40:32Z">2023-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/package/" itemprop="url" rel="index"><span itemprop="name">package</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="tqdm"><a href="#tqdm" class="headerlink" title="tqdm"></a>tqdm</h1><p> Tqdm 是一个快速，<strong>可扩展的Python进度条</strong>，可以在 Python 长循环中添加一个进度提示信息，用户只需要封装任意的迭代器 tqdm(iterator)。</p>
<h2 id="安装与导入"><a href="#安装与导入" class="headerlink" title="安装与导入"></a>安装与导入</h2><p><code>pip install tqdm</code></p>
<p>我们能发现使用的核心是tqdm和trange这两个函数,导入这两个</p>
<p><code>from tqdm import tqdm</code></p>
<p><code>from tqdm import trange</code></p>
<p>其实：<code>trange=tqdm(range())</code></p>
<h2 id="4种使用方式"><a href="#4种使用方式" class="headerlink" title="4种使用方式"></a>4种使用方式</h2><p><code>tqdm</code>是非常通用的，并且可以以多种方式使用。下面给出三个主要部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># 方法1</span><br><span class="line">for i in tqdm(可迭代对象):</span><br><span class="line">	pass</span><br><span class="line"></span><br><span class="line"># 方法2</span><br><span class="line">for idx, i in enumerate(tqdm(可迭代对象)):</span><br><span class="line">	pass</span><br><span class="line">for idx, i in tqdm(enumerate(可迭代对象)):</span><br><span class="line">	pass	</span><br><span class="line"></span><br><span class="line"># 方法3 而如果想要在迭代过程中变更说明文字，还可以预先实例化进度条对象，在需要刷新说明文字的时候执行相应的程序</span><br><span class="line">p = tqdm(可迭代对象)</span><br><span class="line">for idx, i in enumerate(p):</span><br><span class="line">	pass</span><br><span class="line"># 方法4	手动控制更新</span><br><span class="line">with tqdm.tqdm(total=10) as bar:  # total为进度条总的迭代次数</span><br><span class="line">    # 操作1</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    # 更新进度条</span><br><span class="line">    bar.update(1)  # bar.update()里面的数表示更新的次数，和optimizer.step方法类似</span><br><span class="line">    </span><br><span class="line">    # 操作2</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    # 更新进度条</span><br><span class="line">    bar.update(3)</span><br><span class="line">    </span><br><span class="line">    # 操作3</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    # 更新进度条</span><br><span class="line">    bar.update(6)  # 建议不要超过total</span><br><span class="line">    </span><br><span class="line">with tqdm(total=100) as pbar:</span><br><span class="line">    for i in range(10):</span><br><span class="line">        pbar.update(10)</span><br><span class="line"># 也可以这样</span><br><span class="line">pbar = tqdm(total=100)</span><br><span class="line">for i in range(10):</span><br><span class="line">    pbar.update(10)</span><br><span class="line">pbar.close()</span><br></pre></td></tr></table></figure>

<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>而如果想要在迭代过程中变更说明文字，还可以预先实例化进度条对象，在需要刷新说明文字的时候执行相应的程序：</p>
<p>tqdm提供了两个个方法：</p>
<ol>
<li><code>set_description()</code></li>
<li><code>set_postfix()</code></li>
</ol>
<p>这两个方法就类似于print，可以在进度条中显示一些变动的信息，在使用set_description()和set_postfix()时一般会创建一个tqdm.tqdm()对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pbar = tqdm.tqdm(range(epochs), ncols=100)  # ncols设置进度条显示的字符长度，小了就显示不全了</span><br><span class="line"></span><br><span class="line">for idx, element in enumerate(pbar):</span><br><span class="line">    time.sleep(0.01)</span><br><span class="line">    pbar.set_description(f&quot;Epoch &#123;idx&#125;/&#123;epochs&#125;&quot;)</span><br><span class="line">    pbar.set_postfix(&#123;&quot;class&quot;: element&#125;, loss=random.random(), cost_time = random.randrange(0, 100))</span><br></pre></td></tr></table></figure>

<img src="package1/image-20230328122422753.png" alt="image-20230328122422753" style="zoom:50%;" />

<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>tqdm()的返回值是一个可迭代对象，迭代的每一个元素就是iterable的每一个参数。该返回值可以修改进度条信息。示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">with tqdm(range(100), desc=&#x27;Test&#x27;) as tbar:</span><br><span class="line">    for i in tbar:</span><br><span class="line">        tbar.set_postfix(loss=i/100, x=i)</span><br><span class="line">        tbar.update()  # 默认参数n=1，每update一次，进度+n</span><br><span class="line">        time.sleep(0.2)</span><br></pre></td></tr></table></figure>



<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@staticmethod</span><br><span class="line">def format_meter(n, total, elapsed, ncols=None, prefix=&#x27;&#x27;, ascii=False, unit=&#x27;it&#x27;,</span><br><span class="line">                 unit_scale=False, rate=None, bar_format=None, postfix=None,</span><br><span class="line">                 unit_divisor=1000, initial=0, colour=None, **extra_kwargs):</span><br></pre></td></tr></table></figure>

<p>iterable: 可迭代的对象, 在手动更新时不需要进行设置<br>desc: 字符串,左边进度条描述,作为进度条标题<br>total: 预期的迭代次数。一般不填，默认为<code>iterable</code>的长度。<br>leave: bool值, 迭代完成后是否保留进度条。默认保留。<br>file: 输出指向位置, 默认是终端, ⼀般不需要设置<br>ncols: 调整进度条宽度, 默认是根据环境⾃动调节长度, 如果设置为0, 就没有进度条, 只有输出的信息<br>unit: 描述处理项⽬的⽂字, 默认是it, 例如: 100 it/s, 处理照⽚的话设置为img ,则为 100 img/s<br>unit_scale: ⾃动根据国际标准进⾏项⽬处理速度单位的换算, 例如 100000 it/s &gt;&gt; 100k it/s</p>
<p>postfix进度条后缀信息以字典形式传入详细信息</p>
<p>colour: 进度条颜色</p>
<p>还有一个复杂的格式参数bar_formmat，见下一节</p>
<h2 id="进度条含义解释与自定义"><a href="#进度条含义解释与自定义" class="headerlink" title="进度条含义解释与自定义"></a>进度条含义解释与自定义</h2><p>其中<code>xxxit/s</code>表示每秒迭代的次数,it=iteration(一次迭代）</p>
<p>进度百分比|进度条| 当前迭代数/总迭代个数，[消耗时间&lt;剩余时间，迭代的速度]</p>
<p>其会在每一轮从可迭代对象中取得一个值之后，打印遍历进度条，然后再执行循环中的程序。最后面的速度表示执行一个循环所耗费的时间。</p>
<p><strong>复杂参数bar_formmat</strong></p>
<p>默认格式：<code>&#39;&#123;l_bar&#125;&#123;bar&#125;&#123;r_bar&#125;&#39;</code></p>
<p><code>l_bar</code>：进度条左边的文字<br><code>bar</code>: 进度条图形部分<br><code>r_bar</code>: 进度条右边的文字</p>
<pre><code>bar_format  : str, optional
    Specify a custom bar string formatting. May impact performance.
    [default: &#39;&#123;l_bar&#125;&#123;bar&#125;&#123;r_bar&#125;&#39;], where
    l_bar=&#39;&#123;desc&#125;: &#123;percentage:3.0f&#125;%|&#39; and
    r_bar=&#39;| &#123;n_fmt&#125;/&#123;total_fmt&#125; [&#123;elapsed&#125;&lt;&#123;remaining&#125;, &#123;rate_fmt&#125;&#123;postfix&#125;]&#39;
Possible vars: l_bar, bar, r_bar, n, n_fmt, total, total_fmt,
    percentage, elapsed, elapsed_s, ncols, desc, unit,
    rate, rate_fmt, rate_noinv, rate_noinv_fmt,
    rate_inv, rate_inv_fmt, postfix, unit_divisor,
    remaining, remaining_s.
    Note that a trailing &quot;: &quot; is automatically removed after &#123;desc&#125;
    if the latter is empty.
</code></pre>
<p>其具体为：{desc}: 100%|███████████| 10/10 [00:05&lt;00:00, 1.98it/s,{postfix}]</p>
<p>desc、postfix默认为空；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for i in tqdm(range(10), bar_format=&#x27;&#123;desc&#125;|&#123;bar&#125;|&#123;percentage:3.0f&#125;%&#x27;):</span><br><span class="line">    time.sleep(.5)</span><br></pre></td></tr></table></figure>

<p>|█████████████████████|100%</p>
<h2 id="others"><a href="#others" class="headerlink" title="others"></a>others</h2><h3 id="嵌套"><a href="#嵌套" class="headerlink" title="嵌套"></a>嵌套</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tqdm还支持在循环中嵌套使用进度条，例如在for循环中嵌套while循环：</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">for i in tqdm(range(10)):</span><br><span class="line">    for j in tqdm(range(100), leave=False):</span><br><span class="line">        # do something</span><br></pre></td></tr></table></figure>

<p>这样就会在外层循环中显示一个进度条，在内层循环中显示另一个进度条。参数leave用于控制内层进度条是否在外层进度条完成后消失。</p>
<h3 id="在多线程和多进程中使用"><a href="#在多线程和多进程中使用" class="headerlink" title="在多线程和多进程中使用"></a>在多线程和多进程中使用</h3><p>可以通过设置参数desc来给每个进程或线程命名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from tqdm import tqdm</span><br><span class="line">import multiprocessing</span><br><span class="line"></span><br><span class="line">def worker(num):</span><br><span class="line">    for i in tqdm(range(1000000), desc=f&#x27;Worker &#123;num&#125;&#x27;):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with multiprocessing.Pool(4) as p:</span><br><span class="line">        p.map(worker, [1, 2, 3, 4])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样就会在每个进程的进度条上显示进度，并显示进程的名称。</p>
<h3 id="结合pandas的使用"><a href="#结合pandas的使用" class="headerlink" title="结合pandas的使用"></a>结合pandas的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import  pandas as pd</span><br><span class="line">import numpy as  np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randint(0, 100, (10000000, 6)))</span><br><span class="line">tqdm.pandas(desc=&quot;my bar！&quot;)</span><br><span class="line">df.progress_apply(lambda x: x**2)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tqdm对pandas中的apply也提供了支持，用法是：</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">from tqdm.notebook import tqdm</span><br><span class="line"># 每个单独的porgress_apply运行之前一定要先执行tqdm.pandas()</span><br><span class="line">tqdm.pandas()</span><br><span class="line"></span><br><span class="line">df=pd.DataFrame(&#123;&#x27;a&#x27;, range(10)&#125;)</span><br><span class="line">x = df.progress_apply(lambda x: time.sleep(0.2))</span><br></pre></td></tr></table></figure>

<h3 id="减少tqdm进度条在日志文件中的打印频率？"><a href="#减少tqdm进度条在日志文件中的打印频率？" class="headerlink" title="减少tqdm进度条在日志文件中的打印频率？"></a>减少tqdm进度条在日志文件中的打印频率？</h3><p>可以使用嵌套循环，其中包含tqdm的循环和内部循环只是一个简单的for循环</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> outer <span class="keyword">in</span> tqdm(range(<span class="number">0</span>,<span class="number">1e5</span>,<span class="number">1e4</span>)):</span><br><span class="line">    <span class="keyword">for</span> inner <span class="keyword">in</span> range(<span class="number">1e4</span>):</span><br><span class="line">        print(outer+inner)</span><br></pre></td></tr></table></figure>



<p>cankao</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44878336/article/details/124894210">https://blog.csdn.net/weixin_44878336/article/details/124894210</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/KuanLez/p/15974970.html">https://www.cnblogs.com/KuanLez/p/15974970.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42475060/article/details/121661840">https://blog.csdn.net/weixin_42475060/article/details/121661840</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41554005/article/details/117297861">https://blog.csdn.net/qq_41554005/article/details/117297861</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/winter2121/article/details/111356587">https://blog.csdn.net/winter2121/article/details/111356587</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/378474516">https://zhuanlan.zhihu.com/p/378474516</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/04/04/project3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/04/project3/" class="post-title-link" itemprop="url">project3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-03 23:13:08" itemprop="dateCreated datePublished" datetime="2022-04-03T23:13:08Z">2022-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-25 08:43:09" itemprop="dateModified" datetime="2023-03-25T08:43:09Z">2023-03-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">项目</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>hh</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://muyu42.github.io/2022/03/26/project5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="muyu">
      <meta itemprop="description" content="菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cabbage">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/26/project5/" class="post-title-link" itemprop="url">project5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-25 16:09:14" itemprop="dateCreated datePublished" datetime="2022-03-25T16:09:14Z">2022-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-25 08:23:49" itemprop="dateModified" datetime="2023-03-25T08:23:49Z">2023-03-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">项目</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">muyu</p>
  <div class="site-description" itemprop="description">菜鸟写给小白的教程，新手友好，带你快速入门深度学习，领略ai魅力</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/muyu42" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;muyu42" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:7914675@qq.com" title="E-Mail → mailto:7914675@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/weixin_48076759" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_48076759" rel="noopener" target="_blank"><i class="fa fa-fw fa-crosshairs"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">muyu</span>
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_pv"></span>
</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
